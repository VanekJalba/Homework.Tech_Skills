/* ---------------------------JQUERY--------------------------- */
//= partials/_jquery.js
/* ---------------------------JCAROUSEL--------------------------- */
;
//= partials/_jquery.jcarousel.js
;
//= partials/_jcarousel.js
;
/* ---------------------------Masonry--------------------------- */
//= partials/_masonry.pkgd.min.js
;
/* ---------------------------Template--------------------------- */
//= partials/_microTemplates.js
;
$(function () {
  var isActive = false;
  var getData = function (q) {
    var API_KEY = '2656466-4e611d876bc99286937427964';
      var URL = "https://pixabay.com/api/?key="+API_KEY+"&response_group=image_details"+"&per_page=10"+"&q="+encodeURIComponent(q);
      $.getJSON(URL).success(function (data) {
        if (parseInt(data.totalHits) > 0) {
          activityGridInit(data);
        } else {
          console.log('No hits');
        }
      })
  }
  var activityGridInit = function (dataImg) {
    if (isActive === true) {
      $('.activity__grid').masonry('destroy');
      console.log('masonry destroyed');
    };
    var activityGridTmpl = $('#activity__grid__template').html();
    var activityGridHtml = tmpl(activityGridTmpl, {dataImg: dataImg});
    $('.activity__grid').html(activityGridHtml);
    $('.activity__grid').masonry({
    itemSelector: '.activity__grid__item'
    });
    isActive = true;
  }

  var reloadImg = function (e) {
    e.preventDefault();
    var query = searchInput.val();
    if (query.length === 0) {
      return;
    }
    getData(query);
  }
  var searchBtn = $('.activity__box__search__form__submit');
  var searchInput = $('.activity__box__search__form__input');
  searchBtn.click(reloadImg);

  var data2 = localStorage.getItem('data');
  var dataImg = JSON.parse(data2);
  activityGridInit(dataImg);

  // getData('travel');
})
